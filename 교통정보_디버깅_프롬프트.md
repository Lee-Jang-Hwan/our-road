# êµí†µ ì •ë³´ ë””ë²„ê¹…ìš© ì½˜ì†” ë¡œê·¸ ì¶”ê°€ ìš”ì²­

ì°¨ëŸ‰ ëª¨ë“œì—ì„œ êµí†µ ì •ë³´(í†¨ë¹„, íƒì‹œ ìš”ê¸ˆ, IC/í†¨ê²Œì´íŠ¸ ì•ˆë‚´ ì •ë³´)ê°€ ì œëŒ€ë¡œ ë°›ì•„ì™€ì§€ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì½˜ì†” ë¡œê·¸ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.

## ìš”ì²­ ì‚¬í•­

ë‹¤ìŒ ìœ„ì¹˜ì— ìƒì„¸í•œ ì½˜ì†” ë¡œê·¸ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”:

### 1. `lib/api/kakao.ts` - `getCarRoute` í•¨ìˆ˜

- Kakao Mobility API ì‘ë‹µì„ ë°›ì€ ì§í›„ (`data` ë³€ìˆ˜)
- `route.summary.fare` (í†¨ë¹„, íƒì‹œ ìš”ê¸ˆ) í™•ì¸
- `route.sections` ê° êµ¬ê°„ì˜ `guides` ì •ë³´ í™•ì¸
- êµ¬ê°„ë³„ `guides` ì¶”ì¶œ ê³¼ì • (í•„í„°ë§ ì „/í›„)
- ìµœì¢… ë³€í™˜ëœ `CarRoute` ê°ì²´ ì „ì²´ (segments, guides í¬í•¨)

### 2. `actions/routes/get-car-route.ts` - `getCarRoute` Server Action

- API ì‘ë‹µ ë°›ì€ ì§í›„ (`data` ë³€ìˆ˜)
- `route.summary.fare.toll`, `route.summary.fare.taxi` ê°’
- ê° êµ¬ê°„(`section`)ì˜ `guides` ë°°ì—´ ë‚´ìš©
- `allGuides` ë°°ì—´ì— ì¶”ê°€ë˜ëŠ” ê³¼ì •
- ìµœì¢… `carRoute` ê°ì²´ (taxiFare, guides í¬í•¨ ì—¬ë¶€ í™•ì¸)

### 3. `lib/optimize/distance-matrix.ts` - `getRouteInfo` í•¨ìˆ˜

- `getCarRoute` í˜¸ì¶œ í›„ ê²°ê³¼ (`route` ë³€ìˆ˜)
- `route.tollFare`, `route.taxiFare`, `route.guides` ê°’
- `DistanceEntry`ë¡œ ë³€í™˜ëœ ìµœì¢… ë°ì´í„° (fare, taxiFare, guides í¬í•¨ ì—¬ë¶€)

### 4. `actions/optimize/optimize-route.ts` - ì¼ì • ìƒì„± ë¶€ë¶„

- `transportFromOrigin` ìƒì„± ì‹œ: `entry.fare`, `entry.taxiFare`, `entry.guides` ê°’
- `transportToNext` ìƒì„± ì‹œ: ê° êµ¬ê°„ì˜ `fare`, `taxiFare`, `guides` ê°’
- `transportToDestination` ìƒì„± ì‹œ: ìµœì¢… êµ¬ê°„ì˜ ì •ë³´

## ë¡œê·¸ í˜•ì‹

ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ êµ¬ì¡°í™”ëœ ë¡œê·¸ë¥¼ ì¶œë ¥í•´ì£¼ì„¸ìš”:

```typescript
// ì˜ˆì‹œ 1: API ì‘ë‹µ í™•ì¸
console.group("ğŸš— [Kakao API] ê²½ë¡œ ì¡°íšŒ ì‘ë‹µ");
console.log("ì¶œë°œì§€:", options.origin);
console.log("ë„ì°©ì§€:", options.destination);
console.log("API ì‘ë‹µ:", data);
console.log("í†¨ë¹„:", route.summary.fare?.toll);
console.log("íƒì‹œ ìš”ê¸ˆ:", route.summary.fare?.taxi);
console.log("êµ¬ê°„ ìˆ˜:", route.sections.length);
console.groupEnd();

// ì˜ˆì‹œ 2: Guides ì¶”ì¶œ ê³¼ì •
console.group("ğŸ“ [Guides ì¶”ì¶œ]");
route.sections.forEach((section, idx) => {
  console.log(`êµ¬ê°„ ${idx}:`, {
    guides: section.guides,
    í•„í„°ë§ëœ_guides: sectionGuides,
  });
});
console.log("ì „ì²´ Guides:", allGuides);
console.groupEnd();

// ì˜ˆì‹œ 3: ìµœì¢… ë³€í™˜ ê²°ê³¼
console.group("âœ… [ìµœì¢… CarRoute]");
console.log("CarRoute ê°ì²´:", {
  totalDuration: carRoute.totalDuration,
  totalDistance: carRoute.totalDistance,
  tollFare: carRoute.tollFare,
  taxiFare: carRoute.taxiFare,
  segments: carRoute.segments?.length,
  guides: carRoute.guides?.length,
  guides_ìƒì„¸: carRoute.guides,
});
console.groupEnd();

// ì˜ˆì‹œ 4: DistanceEntry ë³€í™˜
console.group("ğŸ“Š [DistanceEntry ë³€í™˜]");
console.log("ì›ë³¸ CarRoute:", route);
console.log("ë³€í™˜ëœ DistanceEntry:", {
  distance: entry.distance,
  duration: entry.duration,
  fare: entry.fare,
  taxiFare: entry.taxiFare,
  carSegments: entry.carSegments?.length,
  guides: entry.guides?.length,
});
console.groupEnd();

// ì˜ˆì‹œ 5: RouteSegment ìƒì„±
console.group("ğŸ›£ï¸ [RouteSegment ìƒì„±]");
console.log("transportFromOrigin:", {
  fare: transportFromOrigin?.fare,
  taxiFare: transportFromOrigin?.taxiFare,
  guides: transportFromOrigin?.guides?.length,
});
console.log("transportToNext:", {
  fare: transportToNext?.fare,
  taxiFare: transportToNext?.taxiFare,
  guides: transportToNext?.guides?.length,
});
console.groupEnd();
```

## í™•ì¸í•˜ê³  ì‹¶ì€ ì •ë³´

1. **API ë ˆë²¨**: Kakao APIì—ì„œ ì‹¤ì œë¡œ `taxiFare`ì™€ `guides` ë°ì´í„°ê°€ ì˜¤ëŠ”ì§€
2. **ë³€í™˜ ë ˆë²¨**: `CarRoute` â†’ `DistanceEntry` ë³€í™˜ ì‹œ ì •ë³´ê°€ ì†ì‹¤ë˜ëŠ”ì§€
3. **ìµœì í™” ë ˆë²¨**: `DistanceEntry` â†’ `RouteSegment` ë³€í™˜ ì‹œ ì •ë³´ê°€ í¬í•¨ë˜ëŠ”ì§€
4. **ì €ì¥ ë ˆë²¨**: DBì— ì €ì¥ë  ë•Œ ëª¨ë“  ì •ë³´ê°€ í¬í•¨ë˜ëŠ”ì§€

## ì¶”ê°€ ìš”ì²­

- ë¡œê·¸ëŠ” ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì¶œë ¥ë˜ë„ë¡ ì¡°ê±´ì„ ì¶”ê°€í•´ì£¼ì„¸ìš” (`process.env.NODE_ENV === 'development'`)
- ê° ë‹¨ê³„ë³„ë¡œ `console.group`ê³¼ `console.groupEnd`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê³„ì¸µì ìœ¼ë¡œ í‘œì‹œ
- ì¤‘ìš”í•œ ê°’ì€ `JSON.stringify`ë¡œ ê¹”ë”í•˜ê²Œ ì¶œë ¥ (ìˆœí™˜ ì°¸ì¡° ì£¼ì˜)
- ë°°ì—´/ê°ì²´ëŠ” ê¸¸ì´/ê°œìˆ˜ì™€ í•¨ê»˜ ìƒì„¸ ë‚´ìš©ë„ ì¶œë ¥

## ì‚¬ìš© ë°©ë²•

1. ê°œë°œ ì„œë²„ ì‹¤í–‰ (`pnpm dev`)
2. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì½˜ì†” ì—´ê¸°
3. ì¼ì • ìµœì í™” ì‹¤í–‰
4. ì½˜ì†”ì—ì„œ ê° ë‹¨ê³„ë³„ ë¡œê·¸ í™•ì¸
